-# app/views/notifications/index.html.haml
.container.py-4
  .d-flex.align-items-center.justify-content-between.mb-3
    %h1.h4.mb-0 Notifications
    - if @unread_count.positive?
      = button_to "Mark all as read (#{@unread_count})",
                  mark_all_read_notifications_path,
                  method: :patch,
                  class: "btn btn-sm btn-outline-secondary"

  - if @notifications.any?
    - @notifications.each do |n|
      .card.shadow-sm.mb-2{ class: (n.read_at.nil? ? "border-primary" : nil) }
        .card-body
          %div.small.text-muted= time_ago_in_words(n.created_at) + " ago"
          %div.mt-1
            - if n.notifiable.is_a?(Post)
              = link_to n.message, post_id_slug_post_path(post_id: n.notifiable_id, slug: n.notifiable.slug)
            - else
              = n.message
        .card-footer.bg-transparent.small
          - if n.read_at
            %span.text-muted Read
          - else
            = button_to "Mark as read", notification_path(n), method: :put, class: "btn btn-sm btn-outline-secondary"
    .mt-3
      = pagy_bootstrap_nav(@pagy)
  - else
    .alert.alert-light.border No notifications yet.
