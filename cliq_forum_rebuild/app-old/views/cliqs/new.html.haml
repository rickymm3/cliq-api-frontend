-# app/views/cliqs/new.html.haml

%main.container.py-4
  - if @parent_cliq
    .mb-3
      %h1.h4.mb-1 Create a new Cliq under
      = render "cliqs/cliq_breadcrumbs", cliq: @parent_cliq
  - else
    .mb-3
      %h1.h4.mb-1 Create a new top-level Cliq

  .card.shadow-sm
    .card-body
      - if @cliq.errors.any?
        .alert.alert-danger.mb-4
          %strong Unable to create this cliq:
          %ul.mb-0
            - @cliq.errors.full_messages.uniq.each do |message|
              %li= message

      = form_with model: @cliq, data: { turbo_frame: "_top" } do |f|
        = f.hidden_field :parent_cliq_id, value: @parent_cliq&.id

        .mb-3
          = f.label :name, "Cliq name", class: "form-label"
          = f.text_field :name, class: "form-control", placeholder: "e.g. Space Exploration"

        .mb-3
          = f.label :description, "What's this cliq about?", class: "form-label"
          = f.text_area :description, class: "form-control", rows: 3, placeholder: "Give others a quick overview..."

        .mt-4.mb-3.border-top.pt-3
          %h2.h5.mb-3 Kick things off with a post
          = f.fields_for :posts do |post_fields|
            .mb-3
              = post_fields.label :title, "Post title", class: "form-label"
              = post_fields.text_field :title, class: "form-control", placeholder: "Start the conversation..."

            .mb-3
              = post_fields.label :content, "Post content", class: "form-label"
              = post_fields.rich_text_area :content, class: "form-control content-textarea", placeholder: "Share some context or ask a question..."

        .d-grid.gap-2.mt-4
          = f.submit "Create Cliq", class: "btn btn-primary btn-lg"
