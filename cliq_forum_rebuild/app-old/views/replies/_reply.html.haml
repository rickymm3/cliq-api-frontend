- display_name = reply.user&.profile&.username || reply.user.email
- initial = display_name.to_s[0].to_s.upcase

%article.reply.card.mb-3{ id: "reply-#{reply.id}" }
  .card-body
    .d-flex.align-items-start.gap-2
      .avatar
        %div.rounded-circle.bg-secondary.text-white.d-flex.align-items-center.justify-content-center{ style: "width:36px;height:36px;font-size:14px;" }
          = initial
      .flex-grow-1
        .d-flex.justify-content-between.align-items-baseline
          .fw-semibold= display_name
          .text-muted.small= time_ago_in_words(reply.created_at)
        .reply__content.mt-1
          = reply.content
        .mt-2
          - if reply.can_accept_child_reply?
            = link_to "Reply",
                      new_post_reply_path(reply.post, parent_reply_id: reply.id, frame_id: "reply_form_#{reply.id}"),
                      class: "btn btn-sm btn-outline-primary",
                      data: { turbo_frame: "reply_form_#{reply.id}" }

  = turbo_frame_tag "reply_form_#{reply.id}"

- children = reply.child_replies.order(created_at: :asc)
.ms-4.mt-2{ id: "children_#{reply.id}" }
  - if children.any?
    - children.each do |child|
      = render "replies/reply", reply: child
