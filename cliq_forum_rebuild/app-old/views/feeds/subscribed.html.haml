-# Global subscribed feed. Must match the target frame used by the nav ("main_content")
= turbo_frame_tag "main_content" do
  .cliq-layout{ data: { controller: "sidebar-layout" } }
    %button.cliq-layout__toggle.cliq-layout__toggle--left.btn.btn-light.btn-sm{ type: "button", data: { action: "sidebar-layout#toggleLeft", sidebar_layout_target: "leftToggle" }, aria: { label: "Toggle left sidebar" } }
      %i.bi
    .cliq-layout__overlay{ data: { sidebar_layout_target: "overlay", action: "click->sidebar-layout#closeOverlays" } }

    .cliq-layout__side.cliq-layout__side--left{ data: { sidebar_layout_target: "leftSide" } }
      .cliq-layout__sidebar
        = render "shared/primary_sidebar"

    .cliq-layout__content{ data: { sidebar_layout_target: "content" } }
      .cliq-layout__content-inner
        .space-y-4
          .rounded-2xl.bg-white.shadow-sm.border.border-slate-200.p-5
            .d-flex.flex-column.flex-lg-row.align-items-lg-center.justify-content-lg-between.gap-4
              .min-w-0
                %h1.h4.mb-1.mb-lg-0 Subscribed
                %p.text-muted.mb-0 Posts from cliqs you’re subscribed to
              = link_to popular_posts_path(scope: :subscribed),
                        class: "btn btn-outline-dark btn-sm d-none d-lg-inline-flex align-items-center gap-2",
                        data: { turbo_frame: "_top", turbo_action: "advance" } do
                %i.bi.bi-fire
                Hot posts

          - if @posts.any?
            = render "cliqs/posts"
          - else
            .rounded-xl.border.border-slate-200.bg-white.p-8.text-center.text-slate-500
              You don’t have any posts here yet.

          = render "cliqs/pager",
                   pagy: @pagy,
                   url: subscribed_path(page: @pagy&.next)

    .cliq-layout__side.cliq-layout__side--right.d-none.d-xl-block{ data: { sidebar_layout_target: "rightSide" } }
      .cliq-layout__sidebar
        = render "feeds/hot_preview", hot_posts: @hot_preview

    %button.cliq-layout__mobile-toggle.btn.btn-primary.btn-sm.d-none{ type: "button", data: { action: "sidebar-layout#toggleMobile", sidebar_layout_target: "mobileToggle" }, aria: { label: "Toggle side panels" } }
      %i.bi.bi-layout-sidebar-inset
      %span.ms-2 Panels
