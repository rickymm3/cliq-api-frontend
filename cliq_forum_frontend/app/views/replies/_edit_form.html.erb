<%# locals: { reply:, cliq_id:, post_id:, error: nil } %>
<div class="card mb-3 border-0 shadow-sm" id="reply-<%= reply['id'] %>">
  <div class="card-body p-3">
    <% if local_assigns[:error] %>
      <div class="alert alert-danger small py-1"><%= error %></div>
    <% end %>

    <%= form_with(scope: :reply, url: cliq_post_reply_path(cliq_id, post_id, reply['id']), method: :patch) do |f| %>
      <div class="mb-2">
        <% 
           # Populate value manually because form_with model is a hash/scope, not an AR object
           val = reply['content'] 
        %>
        <%= f.hidden_field :content, id: "reply_edit_#{reply['id']}_trix", value: val %>
        <trix-editor input="reply_edit_<%= reply['id'] %>_trix" class="trix-content trix-editor-custom p-3" style="min-height: 100px;"></trix-editor>
      </div>
      
      <div class="d-flex justify-content-end gap-2">
        <%= link_to "Cancel", cliq_post_path(cliq_id, post_id), class: "btn btn-sm btn-light text-muted" %> 
        <%= f.submit "Save Changes", class: "btn btn-sm btn-primary" %>
      </div>
    <% end %>
  </div>
</div>
