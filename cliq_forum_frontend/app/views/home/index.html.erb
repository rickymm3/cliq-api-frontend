<div class="container" data-controller="post-interaction">
  
  <!-- Search Bar -->
  <div class="px-3 py-3 mb-3 bg-white border-bottom rounded-top">
    <form action="<%= search_path %>" method="get" class="w-100">
      <div class="input-group">
        <%= text_field_tag :q, "", placeholder: "Search cliqs...", class: "form-control", id: "home-search" %>
        <button class="btn btn-primary" type="submit">
          <i class="bi bi-search"></i>
        </button>
      </div>
    </form>
  </div>
  
  <!-- New Sticky Header -->
  <div class="sticky-top bg-white border-bottom shadow-sm px-3 py-2 mb-3 d-flex align-items-center justify-content-between" style="top: 0; z-index: 1020;">
    
    <!-- Title -->
    <div class="d-flex align-items-center flex-grow-1 overflow-hidden">
      <h1 class="h4 mb-0 text-truncate fw-bold">Welcome to Cliq</h1>
    </div>
  </div>
  
  <div class="row">
    <!-- Main Content -->
    <div class="col-lg-8 p-0">
      <!-- Intro Text -->
      <div class="mb-5 px-3">
        <p class="lead text-muted">Discover discussions, trending posts, and articles</p>
      </div>

      <!-- Recent Posts Section -->
      <section class="mb-5 px-3">
        <div class="d-flex align-items-center mb-4">
          <h2 class="h4 fw-bold mb-0">Fresh Content</h2>
          <span class="badge bg-primary ms-2">New</span>
        </div>

        <%= turbo_frame_tag "posts_feed" do %>
          <% if @recent_posts && @recent_posts.any? %>
            <div class="posts-list">
                <%= render partial: "posts/list", locals: { posts: @recent_posts, pagination: @pagination } %>
            </div>
          <% else %>
              <div class="alert alert-info">
                No posts found. Be the first to post!
              </div>
          <% end %>
        <% end %>
      </section>

      <!-- Articles Section (Coming Soon) -->
      <section class="mb-5 px-3">
        <div class="d-flex align-items-center mb-4">
          <h2 class="h4 fw-bold mb-0">Featured Articles</h2>
          <span class="badge bg-secondary ms-2">Coming Soon</span>
        </div>

        <div class="alert alert-light border py-4">
          <div class="text-center">
            <i class="bi bi-newspaper" style="font-size: 2.5rem; color: #6c757d;"></i>
            <p class="text-muted mt-3 mb-0">Share and discover articles from across the web. Link sharing feature coming soon.</p>
          </div>
        </div>
      </section>
    </div>

    <!-- Right Sidebar -->
    <div class="col-lg-4 p-0 px-3">
      
      <!-- Hot Cliqs -->
      <% if @hot_cliqs && @hot_cliqs.any? %>
        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body">
            <h6 class="card-title fw-bold mb-3">ðŸ”¥ POPULAR CLIQS</h6>
            <div class="list-group list-group-flush">
              <% @hot_cliqs.each do |cliq| %>
                <%= link_to cliq_path(cliq["id"]), class: "list-group-item list-group-item-action border-0 px-0 py-2 d-flex justify-content-between align-items-center" do %>
                   <span><%= cliq["name"] %></span>
                   <span class="badge bg-warning text-dark rounded-pill"><%= cliq["posts_count"] %> posts</span>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>

      <!-- Trending Posts -->
      <% if @hot_posts && @hot_posts.any? %>
        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body">
            <h6 class="card-title fw-bold mb-3">ðŸ“ˆ TRENDING NOW</h6>
            <div class="list-group list-group-flush">
              <% @hot_posts.each do |post| %>
                <%= link_to cliq_post_path(post["cliq"]["id"], post["id"]), class: "list-group-item list-group-item-action border-0 px-0 py-3" do %>
                   <div class="d-flex w-100 justify-content-between">
                     <h6 class="mb-1 text-truncate" style="max-width: 85%;"><%= post["title"] %></h6>
                   </div>
                   <div class="d-flex justify-content-between align-items-center mt-1">
                      <small class="text-muted"><%= post["cliq"]["name"] %></small>
                      <small class="text-danger fw-bold">
                        <i class="bi bi-fire"></i> <%= post["heat_score"] ? post["heat_score"].floor : 0 %>
                      </small>
                   </div>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>

      <!-- Browse All Box -->
      <div class="card border-0 shadow-sm bg-light">
        <div class="card-body text-center">
          <h5 class="card-title">Explore Everything</h5>
          <p class="card-text small text-muted">Dive into all categories and communities.</p>
          <%= link_to "Browse All Cliqs", explore_path, class: "btn btn-outline-secondary w-100" %>
        </div>
      </div>

    </div>
  </div>
</div>

<style>
  .cliq-card {
    transition: all 0.2s ease;
    cursor: pointer;
  }

  .cliq-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12) !important;
  }
</style>
